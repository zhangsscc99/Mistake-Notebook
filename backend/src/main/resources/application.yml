server:
  port: 8080
  servlet:
    context-path: /api
  tomcat:
    connection-timeout: 300000  # 连接超时5分钟
    max-connections: 10000
    threads:
      max: 200

spring:
  profiles:
    active: dev
    
  # JPA 配置
  jpa:
    hibernate:
      ddl-auto: update
    show-sql: true
    properties:
      hibernate:
        dialect: org.hibernate.dialect.MySQLDialect
        format_sql: true
      
  # 文件上传配置
  servlet:
    multipart:
      enabled: true
      max-file-size: 10MB
      max-request-size: 10MB
      
  # MVC配置
  mvc:
    async:
      request-timeout: 300000  # 异步请求超时5分钟
      
  # JSON 配置
  jackson:
    default-property-inclusion: non_null
    date-format: yyyy-MM-dd HH:mm:ss
    time-zone: GMT+8

# 跨域配置
cors:
  allowed-origins: "http://localhost:3060,http://127.0.0.1:3060,http://localhost:3000,http://127.0.0.1:3000,http://103.146.124.206:3060,http://103.146.124.206:3000"
  allowed-methods: "GET,POST,PUT,DELETE,OPTIONS"
  allowed-headers: "*"
  allow-credentials: true

# 阿里云配置
aliyun:
  access-key-id: ${ALIYUN_ACCESS_KEY_ID:not-configured}
  access-key-secret: ${ALIYUN_ACCESS_KEY_SECRET:not-configured}
  region-id: cn-hangzhou
  
  # 通义千问配置（视觉推理）
  dashscope:
    api-key: ${DASHSCOPE_API_KEY:not-configured}
    base-url: ${DASHSCOPE_BASE_URL:https://dashscope.aliyuncs.com/compatible-mode/v1/}
    model: ${DASHSCOPE_MODEL:qwen-turbo-latest}
    application-id: ${DASHSCOPE_APPLICATION_ID:not-configured}
    
    vision:
      model: ${DASHSCOPE_VISION_MODEL:qwen3-vl-plus}
      enable-thinking: ${DASHSCOPE_ENABLE_THINKING:true}
      thinking-budget: ${DASHSCOPE_THINKING_BUDGET:81920}
      max-tokens: ${DASHSCOPE_MAX_TOKENS:4000}
      temperature: ${DASHSCOPE_TEMPERATURE:0.1}

# AI 通用配置（OpenAI 兼容接口）
ai:
  aliyun:
    api-key: ${AI_ALIYUN_API_KEY:not-configured}
    base-url: ${AI_ALIYUN_BASE_URL:https://dashscope.aliyuncs.com/compatible-mode/v1/}
    model: ${AI_ALIYUN_MODEL:qwen-plus}
    application-id: ${AI_ALIYUN_APPLICATION_ID:}
    system-content: ${AI_ALIYUN_SYSTEM_CONTENT:你是一个擅长教育领域的智能助手，回答简洁、准确。}
    payment-model: ${AI_ALIYUN_PAYMENT_MODEL:qwen-plus}
    payment-system-content: ${AI_ALIYUN_PAYMENT_SYSTEM_CONTENT:你是一个有用的AI助手}

# 文件存储配置
file:
  upload:
    path: ./uploads/
    max-size: 10485760  # 10MB

# 日志配置
logging:
  level:
    com.mistake.notebook: DEBUG
    com.mistake.notebook.service.VisionReasoningService: DEBUG
    org.springframework.web: DEBUG
  pattern:
    console: "%d{yyyy-MM-dd HH:mm:ss} [%thread] %-5level %logger{36} - %msg%n"

---
# 开发环境配置
spring:
  config:
    activate:
      on-profile: dev
  datasource:
    driver-class-name: com.mysql.cj.jdbc.Driver
    url: jdbc:mysql://localhost:3306/mistake_notebook?useUnicode=true&characterEncoding=utf8&useSSL=false&serverTimezone=Asia/Shanghai&allowPublicKeyRetrieval=true&createDatabaseIfNotExist=true
    username: root
    password: wyt!!010611ABC

---
# 生产环境配置
spring:
  config:
    activate:
      on-profile: prod
  datasource:
    driver-class-name: com.mysql.cj.jdbc.Driver
    url: jdbc:mysql://localhost:3306/mistake_notebook?useUnicode=true&characterEncoding=utf8&useSSL=false&serverTimezone=GMT%2B8&createDatabaseIfNotExist=true
    username: ${DB_USERNAME:root}
    password: ${DB_PASSWORD:password}
  jpa:
    hibernate:
      ddl-auto: validate
    show-sql: false 